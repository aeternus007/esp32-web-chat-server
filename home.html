<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>yaca</title>
    <link rel="stylesheet" href="style.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
</head>
<body>
    
    <div id="connection_status">Connecting......</div> <!-- set bgcolor to yellow and color to white, instead of the dark-gray bg color and the white text of body -->
    <div id="messages_container"></div>
    <div id="set_name">
        <form>
            <input id="username" type="text" placeholder="Please enter your name" value="Anonymous">
        </form>
        <button id="submit_name" type="button">Start Chatting!</button>
    </div>
    <div id="create_message">
        <form>
            <input id="message" type="text" placeholder="Please enter your name" disabled>
        </form>
        <button id="send_message" type="button" disabled>Send</button>
    </div>

    <script>
        $(function(){
            var username = "";
            var connection = $("#connection_status");
            var messages = $("#messages_container");
            var name_input = $('#set_name');
            var message_input = $("#message");
            var send = $("#send_message");
            var ws = new WebSocket("ws://" + location.hostname + ":80");

            message_input.prop("disabled", true);
            send.prop("disabled", true);
            
            $("#submit_name").click(function() {
                message_input.prop("disabled", false);
                send.prop("disabled", false);
                username = name_input.value();
                name_input.remove();
            });
            
            send.click(function() {
                ws.send(message_input.value())
            });
            
            ws.onopen = function () {
                connection.innerHTML = "Connected!";
            };
            
            ws.onclose = function() {
                connection.innerHTML = "Disconnected! Please Reload This Page...";
                connection.css("background-color","red");
            };

            ws.onmessage = function (evt) {
                messages.append(evt.data);
            };
        });
    </script>
</body>
</html>
